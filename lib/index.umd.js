!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("did-jwt"),require("did-jwt-vc"),require("did-resolver"),require("infra-did-resolver"),require("infra-did-js")):"function"==typeof define&&define.amd?define(["did-jwt","did-jwt-vc","did-resolver","infra-did-resolver","infra-did-js"],r):(e=e||self).infraVerifyJs=r(e.didJwt,e.didJwtVc,e.didResolver,e.infraDidResolver,e.infraDidJs)}(this,function(e,r,t,i,n){function o(){return(o=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)}return n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,function(){function s(e){this.resolver=e.resolver?e.resolver:new t.Resolver(i.getResolver(e.networkConfig)),this.did=e.did?e.did:n.createPubKeyDIDsecp256k1("01").did,this.challenge="",this.knownIssuers=e.knownIssuers}var d=s.prototype;return d.ready=function(){return this.challenge=this.generateChallenge(),{challenge:this.challenge,aud:this.did}},d.generateChallenge=function(){return n.createPubKeyDIDsecp256k1("01").did},d.getVPClaims=function(r){var t=this;return e.decodeJWT(r).payload.vp.verifiableCredential.map(function(e){return t.getVCClaims(e)}).reduce(function(e,r){return o({},r,e)},{})},d.getVCClaims=function(r){return e.decodeJWT(r).payload.vc.credentialSubject},d.isValid=function(r){try{var t=e.decodeJWT(r);if(t.payload.vp)return Promise.resolve(this.isValidVP(r));if(t.payload.vc)return Promise.resolve(this.isValidVC(r));throw new Error("Unsupported type")}catch(e){return Promise.reject(e)}},d.isValidVP=function(e){try{var t=this;return Promise.resolve(r.verifyPresentation(e,t.resolver,{challenge:t.challenge,audience:t.did})).then(function(e){var r=e.payload.vp.verifiableCredential,i=e.signer;return Promise.resolve(t.isRevoked(i.id)).then(function(e){if(e)throw new Error("Deactivated Presenter");return r.map(function(e){return t.isValidVC(e,i.id)},t).reduce(function(e,r){return e&&r},!0)})})}catch(e){return Promise.reject(e)}},d.isValidVC=function(e,t){try{var i=this;return Promise.resolve(r.verifyCredential(e,i.resolver)).then(function(e){if(t&&e.payload.sub!==t)throw new Error("Signer is not the subject of VC");if(!i.isKnownIssuer(e.issuer))throw new Error("Unknown Issuer");return Promise.resolve(i.isRevoked(e.issuer)).then(function(r){if(r)throw new Error("Deactivated Issuer");return Promise.resolve(i.isRevoked(e.payload.vc.id)).then(function(e){if(e)throw new Error("Revoked VC");return!0})})})}catch(e){return Promise.reject(e)}},d.isRevoked=function(e){try{return Promise.resolve(this.resolver.resolve(e)).then(function(e){return!!e.didDocumentMetadata.deactivated})}catch(e){return Promise.reject(e)}},d.isKnownIssuer=function(e){return!!this.knownIssuers.some(function(r){return r.did===e})},s}()});
//# sourceMappingURL=index.umd.js.map
