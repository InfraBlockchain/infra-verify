!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("did-jwt"),require("did-jwt-vc"),require("did-resolver"),require("infra-did-resolver"),require("infra-did-js")):"function"==typeof define&&define.amd?define(["did-jwt","did-jwt-vc","did-resolver","infra-did-resolver","infra-did-js"],r):(e=e||self).infraVerifyJs=r(e.didJwt,e.didJwtVc,e.didResolver,e.infraDidResolver,e.infraDidJs)}(this,function(e,r,i,t,n){function o(){return(o=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var i=arguments[r];for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=i[t])}return e}).apply(this,arguments)}return n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,function(){function s(e){this.resolver=e.resolver?e.resolver:new i.Resolver(t.getResolver(e.networkConfig)),this.did=e.did?e.did:n.createPubKeyDIDsecp256k1("01").did,this.challenge="",this.knownIssuer=e.knownIssuer}var d=s.prototype;return d.ready=function(){return this.challenge=this.generateChallenge(),{challenge:this.challenge,aud:this.did}},d.generateChallenge=function(){return n.createPubKeyDIDsecp256k1("01").did},d.getVPClaims=function(r){var i=this;return e.decodeJWT(r).payload.vp.verifiableCredential.map(function(e){return i.getVCClaims(e)}).reduce(function(e,r){return o({},r,e)},{})},d.getVCClaims=function(r){return e.decodeJWT(r).payload.vc.credentialSubject},d.isValid=function(r){try{var i=e.decodeJWT(r);if(i.payload.vp)return Promise.resolve(this.isValidVP(r));if(i.payload.vc)return Promise.resolve(this.isValidVC(r));throw new Error("Unsupported type")}catch(e){return Promise.reject(e)}},d.isValidVP=function(e){try{var i=this;return Promise.resolve(r.verifyPresentation(e,i.resolver,{challenge:i.challenge,audience:i.did})).then(function(e){var r=e.payload.vp.VerifiedCredential,t=e.payload.signer;if(i.isRevoked(t.did))throw new Error("Deactivated Presenter");return r.map(function(e){return i.isValidVC(e,t.did)},i).reduce(function(e,r){return e&&r},!0)})}catch(e){return Promise.reject(e)}},d.isValidVC=function(e,i){try{var t=this;return Promise.resolve(r.verifyCredential(e,t.resolver)).then(function(e){if(i&&e.payload.sub!==i)throw new Error("Signer is not the subject of VC");if(t.isKnownIssuer(e.issuer))throw new Error("Unknown Issuer");if(t.isRevoked(e.issuer))throw new Error("Deactivated Issuer");if(t.isRevoked(e.payload.vc.id))throw new Error("Revoked VC");return!0})}catch(e){return Promise.reject(e)}},d.isRevoked=function(e){try{return Promise.resolve(this.resolver.resolve(e)).then(function(e){return!!e.didDocumentMetadata.deactivated})}catch(e){return Promise.reject(e)}},d.isKnownIssuer=function(e){for(var r in this.knownIssuer)if(this.knownIssuer[r]===e)return!0;return!1},s}()});
//# sourceMappingURL=index.umd.js.map
